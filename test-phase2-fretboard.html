<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fretboard Component - Phase 2 Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #fafafa;
        }
        
        .test-section h2 {
            color: #555;
            margin-top: 0;
            border-bottom: 2px solid #4ECDC4;
            padding-bottom: 10px;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        label {
            font-weight: bold;
            color: #555;
        }
        
        select, input, button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        button {
            background: #4ECDC4;
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #26D0CE;
        }
        
        button.secondary {
            background: #95E1D3;
        }
        
        button.secondary:hover {
            background: #4ECDC4;
        }
        
        .fretboard-container {
            width: 100%;
            height: 400px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .info-panel {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .info-panel h3 {
            margin-top: 0;
            color: #333;
        }
        
        .highlight-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .highlight-controls label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }
        
        .highlight-controls input[type="checkbox"] {
            margin: 0;
        }
        
        .practice-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .key-signature-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎸 Fretboard Component - Phase 2 Test Suite</h1>
        
        <div class="status success">
            ✅ Phase 2 Features: Scale & Key Visualization, Interval Highlighting, Practice Mode
        </div>
        
        <!-- Basic Scale Display -->
        <div class="test-section">
            <h2>🎵 Basic Scale Display</h2>
            <div class="controls">
                <div class="control-group">
                    <label for="rootNote">Root Note:</label>
                    <select id="rootNote">
                        <option value="C">C</option>
                        <option value="C#">C#</option>
                        <option value="D">D</option>
                        <option value="D#">D#</option>
                        <option value="E">E</option>
                        <option value="F">F</option>
                        <option value="F#">F#</option>
                        <option value="G">G</option>
                        <option value="G#">G#</option>
                        <option value="A">A</option>
                        <option value="A#">A#</option>
                        <option value="B">B</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="scaleType">Scale Type:</label>
                    <select id="scaleType">
                        <option value="major">Major Scale</option>
                        <option value="naturalMinor">Natural Minor</option>
                        <option value="harmonicMinor">Harmonic Minor</option>
                        <option value="melodicMinor">Melodic Minor</option>
                        <option value="pentatonicMajor">Major Pentatonic</option>
                        <option value="pentatonicMinor">Minor Pentatonic</option>
                        <option value="blues">Blues Scale</option>
                        <option value="dorian">Dorian Mode</option>
                        <option value="phrygian">Phrygian Mode</option>
                        <option value="lydian">Lydian Mode</option>
                        <option value="mixolydian">Mixolydian Mode</option>
                        <option value="aeolian">Aeolian Mode</option>
                        <option value="locrian">Locrian Mode</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="instrument">Instrument:</label>
                    <select id="instrument">
                        <option value="guitar">Guitar</option>
                        <option value="ukulele">Ukulele</option>
                        <option value="mandolin">Mandolin</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="displayScale()">Display Scale</button>
                </div>
            </div>
            
            <div class="fretboard-container" id="fretboard"></div>
        </div>
        
        <!-- Key Signature & Transposition -->
        <div class="test-section">
            <h2>🎼 Key Signature & Transposition</h2>
            <div class="controls">
                <div class="control-group">
                    <label for="transposeKey">Transpose to Key:</label>
                    <select id="transposeKey">
                        <option value="C">C</option>
                        <option value="G">G</option>
                        <option value="D">D</option>
                        <option value="A">A</option>
                        <option value="E">E</option>
                        <option value="B">B</option>
                        <option value="F#">F#</option>
                        <option value="F">F</option>
                        <option value="Bb">Bb</option>
                        <option value="Eb">Eb</option>
                        <option value="Ab">Ab</option>
                        <option value="Db">Db</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="transposeScale()">Transpose Scale</button>
                </div>
                
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="getRelativeKey()" class="secondary">Get Relative Key</button>
                </div>
                
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="getParallelKey()" class="secondary">Get Parallel Key</button>
                </div>
            </div>
            
            <div id="keyInfo" class="key-signature-info" style="display: none;"></div>
        </div>
        
        <!-- Interval Highlighting -->
        <div class="test-section">
            <h2>🎨 Interval Highlighting</h2>
            <div class="highlight-controls">
                <label>
                    <input type="checkbox" id="highlightRoot" checked>
                    Root Notes
                </label>
                <label>
                    <input type="checkbox" id="highlightThirds">
                    3rds
                </label>
                <label>
                    <input type="checkbox" id="highlightFifths">
                    5ths
                </label>
                <label>
                    <input type="checkbox" id="highlightSevenths">
                    7ths
                </label>
                <button onclick="applyHighlights()">Apply Highlights</button>
                <button onclick="clearHighlights()" class="secondary">Clear Highlights</button>
            </div>
            
            <div class="info-panel">
                <h3>Interval Colors:</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 20px; height: 20px; background: #4ECDC4; border-radius: 50%;"></div>
                        <span>Root (Unison)</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 20px; height: 20px; background: #F7DC6F; border-radius: 50%;"></div>
                        <span>3rds</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 20px; height: 20px; background: #82E0AA; border-radius: 50%;"></div>
                        <span>5ths</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <div style="width: 20px; height: 20px; background: #D7BDE2; border-radius: 50%;"></div>
                        <span>7ths</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Practice Mode -->
        <div class="test-section">
            <h2>📚 Practice Mode</h2>
            <div class="practice-controls">
                <label>
                    <input type="checkbox" id="practiceMode">
                    Enable Practice Mode
                </label>
                <label for="practiceLevel">Level:</label>
                <input type="range" id="practiceLevel" min="1" max="7" value="1">
                <span id="practiceLevelDisplay">1</span>
                <button onclick="applyPracticeMode()">Apply Practice Mode</button>
            </div>
            
            <div class="info-panel">
                <h3>Practice Mode Features:</h3>
                <ul>
                    <li><strong>Level 1:</strong> Root note only</li>
                    <li><strong>Level 2:</strong> Root + 2nd</li>
                    <li><strong>Level 3:</strong> Root + 2nd + 3rd</li>
                    <li><strong>Level 4:</strong> Root + 2nd + 3rd + 4th</li>
                    <li><strong>Level 5:</strong> Root + 2nd + 3rd + 4th + 5th</li>
                    <li><strong>Level 6:</strong> Root + 2nd + 3rd + 4th + 5th + 6th</li>
                    <li><strong>Level 7:</strong> Complete scale</li>
                </ul>
            </div>
        </div>
        
        <!-- Display Options -->
        <div class="test-section">
            <h2>⚙️ Display Options</h2>
            <div class="controls">
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="showNoteNames" checked>
                        Show Note Names
                    </label>
                </div>
                
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="showScaleDegrees">
                        Show Scale Degrees
                    </label>
                </div>
                
                <div class="control-group">
                    <label>
                        <input type="checkbox" id="showIntervals">
                        Show Intervals
                    </label>
                </div>
                
                <div class="control-group">
                    <label>&nbsp;</label>
                    <button onclick="applyDisplayOptions()">Apply Options</button>
                </div>
            </div>
        </div>
        
        <!-- Status Panel -->
        <div class="test-section">
            <h2>📊 Status & Information</h2>
            <div id="statusPanel" class="info-panel">
                <h3>Current Scale Information:</h3>
                <div id="scaleInfo">No scale displayed</div>
            </div>
        </div>
    </div>

    <script type="module">
        import Fretboard from './components/fretboard/fretboard.js';
        
        let fretboard;
        
        // Initialize fretboard
        function initFretboard() {
            const container = document.getElementById('fretboard');
            fretboard = new Fretboard({
                instrument: 'guitar',
                fretRange: { start: 0, end: 12 },
                showNoteNames: true,
                showScaleDegrees: false,
                showIntervals: false
            });
            
            container.appendChild(fretboard);
            
            // Set up event listeners
            fretboard.addEventListener('scale-changed', (event) => {
                updateScaleInfo(event.detail);
            });
            
            fretboard.addEventListener('note-clicked', (event) => {
                console.log('Note clicked:', event.detail);
            });
        }
        
        // Display scale
        window.displayScale = function() {
            const rootNote = document.getElementById('rootNote').value;
            const scaleType = document.getElementById('scaleType').value;
            const instrument = document.getElementById('instrument').value;
            
            fretboard.setInstrument(instrument);
            fretboard.displayScale(rootNote, scaleType);
            
            updateStatus(`Displaying ${scaleType} scale in ${rootNote} on ${instrument}`);
        };
        
        // Transpose scale
        window.transposeScale = function() {
            const newKey = document.getElementById('transposeKey').value;
            fretboard.transposeScale(newKey);
            updateStatus(`Transposed scale to ${newKey}`);
        };
        
        // Get relative key
        window.getRelativeKey = function() {
            const relativeKey = fretboard.getRelativeKey();
            if (relativeKey) {
                updateStatus(`Relative key: ${relativeKey}`);
                document.getElementById('keyInfo').style.display = 'block';
                document.getElementById('keyInfo').innerHTML = `
                    <strong>Relative Key:</strong> ${relativeKey}<br>
                    <em>This is the relative minor/major of the current scale.</em>
                `;
            }
        };
        
        // Get parallel key
        window.getParallelKey = function() {
            const parallelKeys = fretboard.getParallelKey();
            if (parallelKeys) {
                updateStatus(`Parallel keys: Minor: ${parallelKeys.minor}, Major: ${parallelKeys.major}`);
                document.getElementById('keyInfo').style.display = 'block';
                document.getElementById('keyInfo').innerHTML = `
                    <strong>Parallel Keys:</strong><br>
                    Minor: ${parallelKeys.minor}<br>
                    Major: ${parallelKeys.major}<br>
                    <em>These are the parallel minor and major keys.</em>
                `;
            }
        };
        
        // Apply interval highlights
        window.applyHighlights = function() {
            const highlights = {
                root: document.getElementById('highlightRoot').checked,
                thirds: document.getElementById('highlightThirds').checked,
                fifths: document.getElementById('highlightFifths').checked,
                sevenths: document.getElementById('highlightSevenths').checked
            };
            
            fretboard.highlightIntervals(highlights);
            updateStatus('Applied interval highlights');
        };
        
        // Clear highlights
        window.clearHighlights = function() {
            document.getElementById('highlightRoot').checked = false;
            document.getElementById('highlightThirds').checked = false;
            document.getElementById('highlightFifths').checked = false;
            document.getElementById('highlightSevenths').checked = false;
            
            fretboard.highlightIntervals({
                root: false,
                thirds: false,
                fifths: false,
                sevenths: false
            });
            
            updateStatus('Cleared all highlights');
        };
        
        // Apply practice mode
        window.applyPracticeMode = function() {
            const enabled = document.getElementById('practiceMode').checked;
            const level = parseInt(document.getElementById('practiceLevel').value);
            
            fretboard.setPracticeMode(enabled, level);
            updateStatus(`Practice mode ${enabled ? 'enabled' : 'disabled'} at level ${level}`);
        };
        
        // Apply display options
        window.applyDisplayOptions = function() {
            const options = {
                showNoteNames: document.getElementById('showNoteNames').checked,
                showScaleDegrees: document.getElementById('showScaleDegrees').checked,
                showIntervals: document.getElementById('showIntervals').checked
            };
            
            fretboard.setScaleDisplayOptions(options);
            updateStatus('Applied display options');
        };
        
        // Update scale information
        function updateScaleInfo(scaleData) {
            const scaleInfo = document.getElementById('scaleInfo');
            if (scaleData) {
                const positions = scaleData.positions || [];
                const uniqueNotes = [...new Set(positions.map(p => p.note))];
                
                scaleInfo.innerHTML = `
                    <strong>Scale:</strong> ${scaleData.type} in ${scaleData.root}<br>
                    <strong>Notes:</strong> ${uniqueNotes.join(', ')}<br>
                    <strong>Positions:</strong> ${positions.length} total positions<br>
                    <strong>Key Signature:</strong> ${scaleData.keySignature ? 
                        `${scaleData.keySignature.sharps > 0 ? 
                            `${scaleData.keySignature.sharps} sharp(s)` : 
                            `${scaleData.keySignature.flats} flat(s)`}` : 
                        'None'}
                `;
            } else {
                scaleInfo.innerHTML = 'No scale displayed';
            }
        }
        
        // Update status
        function updateStatus(message) {
            const statusDiv = document.createElement('div');
            statusDiv.className = 'status info';
            statusDiv.textContent = message;
            
            const container = document.querySelector('.container');
            container.insertBefore(statusDiv, container.firstChild.nextSibling);
            
            setTimeout(() => {
                statusDiv.remove();
            }, 3000);
        }
        
        // Practice level display
        document.getElementById('practiceLevel').addEventListener('input', function() {
            document.getElementById('practiceLevelDisplay').textContent = this.value;
        });
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', initFretboard);
        
        // Display initial scale
        setTimeout(() => {
            displayScale();
        }, 100);
    </script>
</body>
</html>